$. = $$ / $$ # 1
$_ = $. + $. # 2
@_ = $. + $_ # 3
$- = $_ + @_ # 5

$-_ = $_ * $- # 10
$__ = @_ * @_ * $-_ * $-_ # 900
@__ = $-_ * $-_ * $-_ # 1000

$_____ = $. - $. # 0, the maximum palindromic product

$___ = $__       # x = 900
($____ = -> {    # x loop
  @_____ = $__   # y = 900
  (@____ = -> {  # y loop
    @_____ += $. # Increment y.
    $-_ = $___ * @_____ # product
    $- = "#{$-_}"       # stringify
    $-_ > $_____ &&     # If product is greater than max
      $-[$. - $.] == $-[$_ + @_] && # and [0] == [5]
      $-[$.] == $-[$_ + $_] &&      # and [1] == [4]
      $-[$_] == $-[@_] ?            # and [2] == [3]
        $_____ = $-_ : $.       # Update maximum product.
    @_____ < @__ ? @____[] : $. # Go again if y < 1000.
  })[]
  $___ += $.                # Increment x.
  $___ < @__ ? $____[] : $. # Go again if x < 1000.
})[]

$> << $_____ << ('' << $_ * ($_ + @_))
